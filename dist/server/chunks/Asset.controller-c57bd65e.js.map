{"version":3,"file":"Asset.controller-c57bd65e.js","sources":["../../../.svelte-kit/adapter-node/chunks/Asset.controller.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport { P as PUBLIC_SERVICE_URL } from \"./public.js\";\nconst articleSchema = new mongoose.Schema({\n  scope: String,\n  state: [String],\n  authorId: String,\n  publisherId: String,\n  coverImgSrc: String,\n  title: String,\n  description: String,\n  markdownText: String,\n  contentTags: [String],\n  url: String,\n  submittedDate: { type: Date, default: Date.now },\n  publishedDate: { type: Date, default: Date.now }\n});\nconst Article = mongoose.model(\"Article\", articleSchema);\nconst userSchema = new mongoose.Schema({\n  permissions: [String],\n  name: String,\n  email: String,\n  image: String\n});\nconst User = mongoose.model(\"User\", userSchema);\nconst assetSchema = new mongoose.Schema({\n  size: {\n    widthPx: Number,\n    heightPx: Number,\n    sizeBytes: Number\n  },\n  ownerId: String,\n  title: String,\n  alt: String,\n  data: Buffer\n});\nconst Asset = mongoose.model(\"Asset\", assetSchema);\nconst AssetController = {\n  async refineAsset(assetDoc) {\n    const { _id, ownerId, size, data, alt, title } = assetDoc;\n    const url = PUBLIC_SERVICE_URL + `/api/assets/${_id}.jpeg`;\n    return {\n      id: _id,\n      ownerId,\n      size,\n      data,\n      alt,\n      title,\n      url\n    };\n  },\n  async get(assetId) {\n    const rawAsset = await Asset.findOne({ _id: assetId });\n    const asset = await AssetController.refineAsset(rawAsset);\n    return asset;\n  },\n  async create({\n    title,\n    alt,\n    data\n  }, ownerId) {\n    const size = {};\n    const assetData = {\n      title,\n      alt,\n      data,\n      ownerId,\n      size\n    };\n    const rawAsset = await Asset.create(assetData);\n    const asset = await AssetController.refineAsset({ ...rawAsset, _id: rawAsset.id });\n    return asset;\n  }\n};\nexport {\n  Article as A,\n  User as U,\n  AssetController as a,\n  Asset as b\n};\n"],"names":[],"mappings":"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"}